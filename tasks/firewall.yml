---
- name: enable ports in firewalld
  firewalld:
    port: "{{ item }}/tcp"
    permanent: true
    state: enabled
    immediate: true
  loop:
    - "{{ zbx_passive_port }}"
    - "{{ zbx_active_port }}"
  when:
    - "'firewalld' in ansible_facts.packages"
    - ansible_facts.services['firewalld.service']['state'] == 'running'

- name: allow ports in ufw
  ufw:
    rule: allow
    port: "{{ item }}"
    proto: tcp
    state: reloaded
  loop:
    - "{{ zbx_passive_port }}"
    - "{{ zbx_active_port }}"
  when:
    - "'ufw' in ansible_facts.packages"
    - ansible_facts.services['ufw.service']['state'] == 'running'
